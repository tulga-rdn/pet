Failed to load neighbors_convert.so: /home/sodjarga/projects/pet_myfork/pet/src/neighbors_convert.so: undefined symbol: _ZN5torch3jit17parseSchemaOrNameERKSsb
[2024-11-07 18:24:25][INFO] - Initializing PET training...
[2024-11-07 18:24:25][INFO] - Starting training at: 2024-11-07 18:24:25
[2024-11-07 18:24:25][INFO] - Training configuration:
Output directory: results
Training using device: cuda:0
Output dimensionality: 1
Target type: structural
Target aggregation: sum
Random seed: 0
CUDA is deterministic: False
[2024-11-07 18:24:25][INFO] - Convering structures to PyG graphs...
[2024-11-07 18:24:25][INFO] - Pre-processing training data...
[2024-11-07 18:24:25][INFO] - Initializing the model...
[2024-11-07 18:24:25][INFO] - Starting training for 1000 epochs
==================================================
last_layer_features0=torch.Size([20, 512])
positions=[tensor([[ 1.3223, -1.1953, -0.7560],
        [-0.2829,  0.3663,  0.1470],
        [-0.4097,  1.3386,  1.0691],
        [ 0.7107, -0.5511,  0.2874],
        [-1.3284, -0.0645, -0.6841],
        [-1.0865,  2.1295,  0.7302],
        [ 0.3099,  1.7526,  1.5634],
        [ 1.2735, -0.1880,  1.1315],
        [-0.8743, -0.7627, -1.5154],
        [-1.9293,  0.8150, -0.9299],
        [ 0.6513, -0.7720, -1.4645],
        [ 1.2797, -2.2016, -0.6462],
        [ 2.2670, -0.9400, -0.9548]], dtype=torch.float64), tensor([[ 1.2362e+00, -5.5806e-01, -1.5378e-01],
        [-1.0999e-01,  6.1414e-02,  3.8919e-03],
        [-9.3832e-02,  1.2208e+00,  5.4745e-01],
        [-1.0652e+00, -7.0531e-01, -4.1388e-01],
        [ 1.4006e+00, -1.4530e+00,  2.6466e-01],
        [ 1.9923e+00, -4.6434e-04,  4.8078e-01],
        [ 1.5845e+00, -8.1105e-01, -1.0794e+00]], dtype=torch.float64)],                
charges=[tensor([[-0.2300]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.2364]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1547]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.3674]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.3188]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[0.0112]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[0.0512]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.0682]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.2145]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.0755]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.2744]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1438]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1181]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.2132]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1901]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.0049]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.2048]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1873]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1039]], device='cuda:0', grad_fn=<AddmmBackward0>), tensor([[-0.1863]], device='cuda:0', grad_fn=<AddmmBackward0>)]
Traceback (most recent call last):
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/bin/pet_train", line 8, in <module>
    sys.exit(main())
             ^^^^^^
  File "/home/sodjarga/projects/pet_myfork/pet/src/train_model.py", line 577, in main
    fit_pet(
  File "/home/sodjarga/projects/pet_myfork/pet/src/train_model.py", line 276, in fit_pet
    predictions_energies, predictions_forces, last_layer_features = model(
                                                                    ^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sodjarga/projects/pet_myfork/pet/src/pet.py", line 767, in forward
    potentials = self.calculator(
                 ^^^^^^^^^^^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torchpme/calculators/base.py", line 344, in forward
    ) = self._validate_compute_parameters(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/sodjarga/miniconda3/envs/cosmo1_re/lib/python3.12/site-packages/torchpme/calculators/base.py", line 159, in _validate_compute_parameters
    raise ValueError(
ValueError: Got inconsistent numbers of positions (2) and charges (20)
